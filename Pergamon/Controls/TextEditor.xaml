<UserControl x:Class="Pergamon.TextEditor"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             xmlns:local="clr-namespace:Pergamon"
             mc:Ignorable="d" 
             d:DesignHeight="250" d:DesignWidth="400" 
             Name="control"
             Style="{DynamicResource controlStyle}"
             >

    <UserControl.Resources>

        <Style x:Key="controlStyle" TargetType="{x:Type local:TextEditor}">

            <Setter Property="Template">
                <Setter.Value>
                    <ControlTemplate TargetType="{x:Type local:TextEditor}">

                        <!--Border for main container-->
                        <Border
                            BorderThickness="1"
                            BorderBrush="{StaticResource DefaultBorderColorBrush}"
                            Background="{Binding Background, ElementName=control}"
                            Padding="{Binding Padding, ElementName=control}"
                            Margin="{Binding Margin, ElementName=control}"
                            Name="mainContainer"
                            >

                            <DockPanel 
                                LastChildFill="True"
                                Background="White"
                                >

                                <!--Tabs-->
                                <StackPanel
                                   Name="tabs"
                                   Orientation="Horizontal"
                                   Background="{Binding BarBackground, ElementName=control}"
                                   DockPanel.Dock="{Binding BarPlacement, ElementName=control}"
                                    >

                                    <!--Font options-->
                                    <StackPanel
                                        Orientation="Horizontal"
                                        
                                        >

                                        <!--Selected font-->
                                        <ComboBox
                                            FontWeight="Normal"
                                            FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            ItemsSource="{Binding FontFamilies}"
                                            SelectedItem="{Binding SelectedFontFamily}"
                                            
                                            >
                                            <ComboBox.ItemsPanel>
                                                <ItemsPanelTemplate>
                                                    <VirtualizingStackPanel
                                                        VirtualizingPanel.ScrollUnit="Pixel"
                                                        />
                                                </ItemsPanelTemplate>
                                            </ComboBox.ItemsPanel>
                                            <ComboBox.ItemTemplate>
                                                <DataTemplate>
                                                    <Label Content="{Binding}"
                                                       FontFamily="{Binding}"/>
                                                </DataTemplate>
                                            </ComboBox.ItemTemplate>
                                        </ComboBox>

                                        <!--Font size-->
                                        <ComboBox 
                                            FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            SelectedItem="{Binding SelectedFontSize, Mode=TwoWay, UpdateSourceTrigger=PropertyChanged}"
                                            ItemsSource="{Binding FontSizes}">

                                        </ComboBox>

                                    </StackPanel>

                                    <!--Separator-->
                                    <Border 
                                        Style="{StaticResource Separator}"
                                        Grid.Column="1"
                                        Background="{Binding Foreground, ElementName=firstIcon}"
                                        />

                                    <!--Text edit options-->
                                    <StackPanel 
                                        Name="textEditSection"
                                        Orientation="Horizontal">

                                        <!--Bold-->
                                        <ToggleButton Style="{StaticResource PressableIconButton}"
                                                Name="firstIcon"
                                                Content="{StaticResource FontAwesomeBald}"
                                                ToolTip="Bold"
                                                Foreground="{Binding BarForeground, ElementName=control}"
                                                Command="EditingCommands.ToggleBold"
                                                CommandTarget="{Binding ElementName=editor}"
                                                IsChecked="{Binding IsBoldChecked}"
                                                FocusManager.FocusedElement="{x:Reference Name=editor}"
                                                />

                                        <!--Italic-->
                                        <ToggleButton Style="{StaticResource PressableIconButton}"
                                                Content="{StaticResource FontAwesomeItalic}"
                                                ToolTip="Italic"
                                                Foreground="{Binding Foreground, ElementName=firstIcon}"
                                                Command="EditingCommands.ToggleItalic"
                                                CommandTarget="{Binding ElementName=editor}"
                                                IsChecked="{Binding IsItalicChecked}"
                                                FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            />

                                        <!--Underline-->
                                        <ToggleButton Style="{StaticResource PressableIconButton}"
                                                Content="{StaticResource FontAwesomeUnderLine}"
                                                ToolTip="Underline"
                                                Foreground="{Binding Foreground, ElementName=firstIcon}"
                                                Command="EditingCommands.ToggleUnderline"
                                                CommandTarget="{Binding ElementName=editor}"
                                                IsChecked="{Binding IsUnderlineChecked}"
                                                FocusManager.FocusedElement="{x:Reference Name=editor}"                                            
                                                      />

                                        <!--Marker-->
                                        <StackPanel Orientation="Vertical"
                                                    Margin="8"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    ToolTip="Mark"
                                                    >

                                            <ToggleButton Style="{StaticResource PressableIconButton}"
                                                    Content="{StaticResource FontAwesomeMarker}"
                                                    Margin="0"
                                                    Foreground="{Binding Foreground, ElementName=firstIcon}"
                                                    Command="{Binding ShowMarkerColorPickerCommand}"
                                                    FocusManager.FocusedElement="{x:Reference Name=editor}"
                                                    />

                                            <Border Height="4"
                                                    Background="Yellow"
                                                    />
                                        </StackPanel>

                                        <!--FontColor-->
                                        <StackPanel Orientation="Vertical"
                                                    Margin="8"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center"
                                                    ToolTip="Select font color"
                                                    >

                                            <ToggleButton Style="{StaticResource PressableIconButton}"
                                                Content="{StaticResource FontAwesomeFont}"
                                                Margin="0"
                                                Foreground="{Binding Foreground, ElementName=firstIcon}"
                                                Command="{Binding ShowFontColorPickerCommand}"
                                                FocusManager.FocusedElement="{x:Reference Name=editor}"
                                                />

                                            <Border Height="4"
                                                Background="black"
                                                />
                                        </StackPanel>

                                    </StackPanel>

                                    <!--Separator-->
                                    <Border 
                                        Style="{StaticResource Separator}"
                                        Grid.Column="1"
                                        Background="{Binding Foreground, ElementName=firstIcon}"
                                        />

                                    <!--Aligment-->
                                    <StackPanel 
                                        Name="aligmentSection"
                                        Orientation="Horizontal">

                                        <!--Align left-->
                                        <ToggleButton 
                                            x:Name="alignLeftButton"
                                            Style="{StaticResource PressableIconButton}"
                                            Content="{StaticResource FontAwesomeAlignLeft}"
                                            Foreground="{Binding Foreground, ElementName=firstIcon}"
                                            ToolTip="Align to left"
                                            Command="EditingCommands.AlignLeft"
                                            CommandTarget="{Binding ElementName=editor}"
                                            IsChecked="{Binding IsLeftAlignChecked}"
                                            FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            />

                                        <!--Align right-->
                                        <ToggleButton Style="{StaticResource PressableIconButton}"
                                                Content="{StaticResource FontAwesomeAlignRight}"
                                                Foreground="{Binding Foreground, ElementName=firstIcon}"
                                                ToolTip="Align to right"
                                                Command="EditingCommands.AlignRight"
                                                CommandTarget="{Binding ElementName=editor}"
                                                IsChecked="{Binding IsRightAlignChecked}"
                                                FocusManager.FocusedElement="{x:Reference Name=editor}"
                                                      />

                                        <!--Align center-->
                                        <ToggleButton Style="{StaticResource PressableIconButton}"
                                                Content="{StaticResource FontAwesomeAlignCenter}"
                                                Foreground="{Binding Foreground, ElementName=firstIcon}"
                                                ToolTip="Align to center"
                                                Command="EditingCommands.AlignCenter"
                                                CommandTarget="{Binding ElementName=editor}"
                                                IsChecked="{Binding IsCenterAlignChecked}"
                                                FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            />

                                        <!--Justify-->
                                        <ToggleButton Style="{StaticResource PressableIconButton}"
                                            Foreground="{Binding Foreground, ElementName=firstIcon}"
                                            Content="{StaticResource FontAwesomeAlignJustify}"
                                            ToolTip="Justify"
                                            Command="EditingCommands.AlignJustify"
                                            CommandTarget="{Binding ElementName=editor}"
                                            IsChecked="{Binding IsJustifyChecked}"
                                            FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            />

                                    </StackPanel>

                                    <!--Separator-->
                                    <Border 
                                        Style="{StaticResource Separator}"
                                        Grid.Column="1"
                                        Background="{Binding Foreground, ElementName=firstIcon}"
                                        />

                                    <!--Lists-->
                                    <StackPanel 
                                        Name="listsSection"
                                        Orientation="Horizontal">

                                        <!--Bullets-->
                                        <ToggleButton 
                                            Style="{StaticResource PressableIconButton}"
                                            Content="{StaticResource FontAwesomeDotedList}"
                                            Foreground="{Binding Foreground, ElementName=firstIcon}"
                                            ToolTip="Dotted list"
                                            Command="EditingCommands.ToggleBullets"
                                            CommandTarget="{Binding ElementName=editor}"
                                            IsChecked="{Binding IsDottedListChecked}"
                                            FocusManager.FocusedElement="{x:Reference Name=editor}"
                                            />

                                        <!--Numeric list-->
                                        <ToggleButton 
                                            Style="{StaticResource PressableIconButton}"
                                            Content="{StaticResource FontAwesomeNumberList}"
                                            Foreground="{Binding Foreground, ElementName=firstIcon}"
                                            ToolTip="Numeric list"
                                            Command="EditingCommands.ToggleNumbering"
                                            CommandTarget="{Binding ElementName=editor}"
                                            IsChecked="{Binding IsNumericListChecked}"
                                            FocusManager.FocusedElement="{x:Reference Name=editor}"
                                          />


                                    </StackPanel>

                                </StackPanel>

                                <!--Editor-->
                                    <RichTextBox
                                        x:Name="editor"
                                        Focusable="True"
                                        FontFamily="{Binding DefaultFontFamily, ElementName=control}"
                                        SelectionChanged="editor_SelectionChanged"
                                        IsInactiveSelectionHighlightEnabled="True"
                                        SelectionBrush="Blue"
                                        Background="{Binding Background, ElementName=mainContainer}"
                                        Foreground="{Binding Foreground, ElementName=control}"
                                        BorderThickness="0"
                                        BorderBrush="Transparent"
                                        AllowDrop="True"
                                        SpellCheck.SpellingReform="Postreform"
                                        AcceptsTab="True"
                                        AcceptsReturn="True"
                                        Margin="0"
                                        Padding="0"
                                        >

                                        <!--Deletes spacing betwwen lines-->
                                        <RichTextBox.Resources>
                                            <Style TargetType="{x:Type Paragraph}">
                                                <Setter Property="Margin" Value="0" />
                                            </Style>
                                        </RichTextBox.Resources>

                                    </RichTextBox>

                            </DockPanel>
                        </Border>

                        <!--Triggers-->
                        <ControlTemplate.Triggers>
                            <Trigger Property="BarPlacement" Value="Left">
                                <Setter Property="Orientation" TargetName="tabs" Value="Vertical"/>
                                <Setter Property="Orientation" TargetName="aligmentSection" Value="Vertical"/>
                                <Setter Property="Orientation" TargetName="textEditSection" Value="Vertical"/>
                            </Trigger>
                            <Trigger Property="BarPlacement" Value="Right">
                                <Setter Property="Orientation" TargetName="tabs" Value="Vertical"/>
                                <Setter Property="Orientation" TargetName="aligmentSection" Value="Vertical"/>
                                <Setter Property="Orientation" TargetName="textEditSection" Value="Vertical"/>
                            </Trigger>
                        </ControlTemplate.Triggers>
                    </ControlTemplate>
                </Setter.Value>
            </Setter>
        </Style>
    </UserControl.Resources>



</UserControl>
